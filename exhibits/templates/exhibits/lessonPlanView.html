{% extends "calisphere/base.html,calisphere/pjaxTemplates/pjax-base.html"|pjax:request %}
{% load calisphere-extras %}
{% load markdown_filter %}

{% block page-metadata %}
{# {% include "calisphere/microdata.html" with title=item.title.0 description=item.description %} #}
{% endblock %}

{% block content %}
  <div class="modal fade" id="js-exhibit-item" tabindex="-1" role="dialog">
    <div class="modal-dialog" style="width: 100%;">
      <div class="modal-header" style="margin-bottom: 10px; border-bottom: 0">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="color: #fff; text-shadow: 0; opacity: 1" data-url="{{ lessonPlan.get_absolute_url }}"><span aria-hidden="true">&times;</span></button>
      </div>
      <div class="modal-content" style="border-radius: 0;">
        <div id="js-exhibit-item__container">
          {% block itemContent %}
          {% endblock %}
        </div>
      </div>
    </div>
  </div>

  <nav role="navigation">
    <ol id="global__breadcrumb">
      <li><a href="{% url 'for-teachers:lessonPlanDirectory' %}" data-pjax="js-pageContent">Just for Teachers</a></li>
    </ol>
  </nav>
  
  <h1 class="lessonplan__header" id="js-exhibit-title" data-slug="{{ lessonPlan.slug }}">Lesson Plan: {{ lessonPlan.title }}</h1>
  <h2 class="lessonplan__h2">{{ lessonPlan.sub_title }}</h2>

  <div class="lessonplan__info">
    <div class="row">
      <div class="col-md-4">
        <div class="lessonplan__info-box">
          <button class="lessonPlan"><span class="fa fa-arrow-circle-o-down"></span> Download Lesson Plan</button>
        </div>
      </div>
      <div class="col-md-4">
        <div class="lessonplan__info-box">
          <b>Unit Overview:</b><br>
          {% include "exhibits/render_as.html" with render_as=lessonPlan.render_as text=lessonPlan.overview truncate=False container_class="" %}
        </div>
      </div>
      <div class="col-md-4">
        <div class="lessonplan__info-box">
          <b>Grade Level Recommendation:</b><br>
          {{ lessonPlan.grade_level }}<br><br>
          <b>Relates to:</b>
          {% for lpt in lessonPlan.lessonplantheme_set.all %}{% if forloop.counter != 1 %}, {% endif %}<a href="{{ lpt.theme.get_absolute_url }}">{{ lpt.theme }}</a>{% endfor %}
        </div>
      </div>
    </div>
  </div>
  
  <div class="exhibit__items">
    <h2 class="exhibit__items-header">Primary sources used in this lesson plan ({{ exhibitItems|length }}):</h2>
    {% if exhibitItems|length > 12 %}<a href="javascript: void(0)" class="js-show-all-exhibit-items">View all</a>{% endif %}
    {% include "exhibits/exhibit_items.html" with url_name='for-teachers:lessonPlanItemView' url_id=lessonPlan.id %}    
  </div>
  
  
  {% if lessonPlan.byline %}
  <div class="row">
    <h2>About this lesson plan:</h2>
    {% include "exhibits/render_as.html" with render_as=lessonPlan.byline_render_as text=lessonPlan.byline truncate=False container_class="" %}
  </div>
  {% endif %}
  
  {% if lessonPlan.lessonplanexhibit_set.all|length > 0 %}
  <div class="exhibit__related-materials">
    <h3>Explore exhibitions related to "{{ lessonPlan.title }}" ({{ lessonPlan.lessonplanexhibit_set.all|length }}):</h3>
    <div class="row js-related-carousel exhibit__related-carousel">
      {% for lpe in lessonPlan.lessonplanexhibit_set.all %}
        <div class="col-xs-2 col-md-3">
          <a href="{{ lpe.exhibit.get_absolute_url }}" data-pjax="js-pageContent">
            <div class="exhibit__lockup--small">
              <div class="aspect-ratio-content exhibit__lockup--small-image" style="background-image: url({{ lpe.exhibit.exhibit_lockup_sm }});">
                <div class="exhibit__lockup--small-title">{{ lpe.exhibit.title }}</div>
              </div>
            </div>
          </a>
        </div>
      {% endfor %}
    </div>
  {% endif %}
  
  {% if relatedThemes|length > 0 %}
    {% for theme, relatedLessons in relatedThemes %}
      {% if relatedLessons|length > 0 %}
        <h3>Other lesson plans about "<a href="{{ theme.get_absolute_url }}">{{ theme }}</a>" ({{ relatedLessons|length }}):</h3>
        <div class="row js-related-carousel exhibit__related-carousel">
          {% for lp in relatedLessons %}
            <div class="col-xs-2 col-md-3">
              <a href="{{ lp.lessonPlan.get_absolute_url }}">
                <div class="exhibit__lesson-lockup">
                  <div class="aspect-ratio-content exhibit__lesson-lockup-image" style="background-image: url({{ exhibitMedia }}{{ lp.lessonPlan.hero }});">
                    <div class="exhibit__lesson-lockup-title">{{ lp.lessonPlan }}</div>
                  </div>
                </div>
              </a>
            </div>
          {% endfor %}
        </div>
      {% endif %}
    {% endfor %}
  {% endif %}
  
  </div>

{% endblock %}
